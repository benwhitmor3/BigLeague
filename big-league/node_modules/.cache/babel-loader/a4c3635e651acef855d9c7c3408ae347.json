{"ast":null,"code":"import { print } from 'graphql';\nimport { action, observable } from 'mobx';\nimport { GraphQLClient } from 'graphql-request';\nimport { resolveIdentifier, getEnv, recordPatches, types, getParent, getType, applySnapshot, addDisposer, onSnapshot } from 'mobx-state-tree';\nconst preserveCamelCase = string => {\n  let isLastCharLower = false;\n  let isLastCharUpper = false;\n  let isLastLastCharUpper = false;\n  for (let i = 0; i < string.length; i++) {\n    const character = string[i];\n    if (isLastCharLower && /[a-zA-Z]/.test(character) && character.toUpperCase() === character) {\n      string = string.slice(0, i) + '-' + string.slice(i);\n      isLastCharLower = false;\n      isLastLastCharUpper = isLastCharUpper;\n      isLastCharUpper = true;\n      i++;\n    } else if (isLastCharUpper && isLastLastCharUpper && /[a-zA-Z]/.test(character) && character.toLowerCase() === character) {\n      string = string.slice(0, i - 1) + '-' + string.slice(i - 1);\n      isLastLastCharUpper = isLastCharUpper;\n      isLastCharUpper = false;\n      isLastCharLower = true;\n    } else {\n      isLastCharLower = character.toLowerCase() === character && character.toUpperCase() !== character;\n      isLastLastCharUpper = isLastCharUpper;\n      isLastCharUpper = character.toUpperCase() === character && character.toLowerCase() !== character;\n    }\n  }\n  return string;\n};\nconst camelCase = (input, options) => {\n  if (!(typeof input === 'string' || Array.isArray(input))) {\n    throw new TypeError('Expected the input to be `string | string[]`');\n  }\n  options = Object.assign({\n    pascalCase: false\n  }, options);\n  const postProcess = x => options.pascalCase ? x.charAt(0).toUpperCase() + x.slice(1) : x;\n  if (Array.isArray(input)) {\n    input = input.map(x => x.trim()).filter(x => x.length).join('-');\n  } else {\n    input = input.trim();\n  }\n  if (input.length === 0) {\n    return '';\n  }\n  if (input.length === 1) {\n    return options.pascalCase ? input.toUpperCase() : input.toLowerCase();\n  }\n  const hasUpperCase = input !== input.toLowerCase();\n  if (hasUpperCase) {\n    input = preserveCamelCase(input);\n  }\n  input = input.replace(/^[_.\\- ]+/, '').toLowerCase().replace(/[_.\\- ]+(\\w|$)/g, (_, p1) => p1.toUpperCase()).replace(/\\d+(\\w|$)/g, m => m.toUpperCase());\n  return postProcess(input);\n};\nvar camelcase = camelCase;\n// TODO: Remove this for the next major release\nvar default_1 = camelCase;\ncamelcase.default = default_1;\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\nfunction commonjsRequire() {\n  throw new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');\n}\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\nvar pluralize = createCommonjsModule(function (module, exports) {\n  /* global define */\n\n  (function (root, pluralize) {\n    /* istanbul ignore else */\n    if (typeof commonjsRequire === 'function' && 'object' === 'object' && 'object' === 'object') {\n      // Node.\n      module.exports = pluralize();\n    } else {\n      // Browser global.\n      root.pluralize = pluralize();\n    }\n  })(commonjsGlobal, function () {\n    // Rule storage - pluralize and singularize need to be run sequentially,\n    // while other rules can be optimized using an object for instant lookups.\n    var pluralRules = [];\n    var singularRules = [];\n    var uncountables = {};\n    var irregularPlurals = {};\n    var irregularSingles = {};\n\n    /**\n     * Sanitize a pluralization rule to a usable regular expression.\n     *\n     * @param  {(RegExp|string)} rule\n     * @return {RegExp}\n     */\n    function sanitizeRule(rule) {\n      if (typeof rule === 'string') {\n        return new RegExp('^' + rule + '$', 'i');\n      }\n      return rule;\n    }\n\n    /**\n     * Pass in a word token to produce a function that can replicate the case on\n     * another word.\n     *\n     * @param  {string}   word\n     * @param  {string}   token\n     * @return {Function}\n     */\n    function restoreCase(word, token) {\n      // Tokens are an exact match.\n      if (word === token) return token;\n\n      // Lower cased words. E.g. \"hello\".\n      if (word === word.toLowerCase()) return token.toLowerCase();\n\n      // Upper cased words. E.g. \"WHISKY\".\n      if (word === word.toUpperCase()) return token.toUpperCase();\n\n      // Title cased words. E.g. \"Title\".\n      if (word[0] === word[0].toUpperCase()) {\n        return token.charAt(0).toUpperCase() + token.substr(1).toLowerCase();\n      }\n\n      // Lower cased words. E.g. \"test\".\n      return token.toLowerCase();\n    }\n\n    /**\n     * Interpolate a regexp string.\n     *\n     * @param  {string} str\n     * @param  {Array}  args\n     * @return {string}\n     */\n    function interpolate(str, args) {\n      return str.replace(/\\$(\\d{1,2})/g, function (match, index) {\n        return args[index] || '';\n      });\n    }\n\n    /**\n     * Replace a word using a rule.\n     *\n     * @param  {string} word\n     * @param  {Array}  rule\n     * @return {string}\n     */\n    function replace(word, rule) {\n      return word.replace(rule[0], function (match, index) {\n        var result = interpolate(rule[1], arguments);\n        if (match === '') {\n          return restoreCase(word[index - 1], result);\n        }\n        return restoreCase(match, result);\n      });\n    }\n\n    /**\n     * Sanitize a word by passing in the word and sanitization rules.\n     *\n     * @param  {string}   token\n     * @param  {string}   word\n     * @param  {Array}    rules\n     * @return {string}\n     */\n    function sanitizeWord(token, word, rules) {\n      // Empty string or doesn't need fixing.\n      if (!token.length || uncountables.hasOwnProperty(token)) {\n        return word;\n      }\n      var len = rules.length;\n\n      // Iterate over the sanitization rules and use the first one to match.\n      while (len--) {\n        var rule = rules[len];\n        if (rule[0].test(word)) return replace(word, rule);\n      }\n      return word;\n    }\n\n    /**\n     * Replace a word with the updated word.\n     *\n     * @param  {Object}   replaceMap\n     * @param  {Object}   keepMap\n     * @param  {Array}    rules\n     * @return {Function}\n     */\n    function replaceWord(replaceMap, keepMap, rules) {\n      return function (word) {\n        // Get the correct token and case restoration functions.\n        var token = word.toLowerCase();\n\n        // Check against the keep object map.\n        if (keepMap.hasOwnProperty(token)) {\n          return restoreCase(word, token);\n        }\n\n        // Check against the replacement map for a direct word replacement.\n        if (replaceMap.hasOwnProperty(token)) {\n          return restoreCase(word, replaceMap[token]);\n        }\n\n        // Run all the rules against the word.\n        return sanitizeWord(token, word, rules);\n      };\n    }\n\n    /**\n     * Check if a word is part of the map.\n     */\n    function checkWord(replaceMap, keepMap, rules, bool) {\n      return function (word) {\n        var token = word.toLowerCase();\n        if (keepMap.hasOwnProperty(token)) return true;\n        if (replaceMap.hasOwnProperty(token)) return false;\n        return sanitizeWord(token, token, rules) === token;\n      };\n    }\n\n    /**\n     * Pluralize or singularize a word based on the passed in count.\n     *\n     * @param  {string}  word      The word to pluralize\n     * @param  {number}  count     How many of the word exist\n     * @param  {boolean} inclusive Whether to prefix with the number (e.g. 3 ducks)\n     * @return {string}\n     */\n    function pluralize(word, count, inclusive) {\n      var pluralized = count === 1 ? pluralize.singular(word) : pluralize.plural(word);\n      return (inclusive ? count + ' ' : '') + pluralized;\n    }\n\n    /**\n     * Pluralize a word.\n     *\n     * @type {Function}\n     */\n    pluralize.plural = replaceWord(irregularSingles, irregularPlurals, pluralRules);\n\n    /**\n     * Check if a word is plural.\n     *\n     * @type {Function}\n     */\n    pluralize.isPlural = checkWord(irregularSingles, irregularPlurals, pluralRules);\n\n    /**\n     * Singularize a word.\n     *\n     * @type {Function}\n     */\n    pluralize.singular = replaceWord(irregularPlurals, irregularSingles, singularRules);\n\n    /**\n     * Check if a word is singular.\n     *\n     * @type {Function}\n     */\n    pluralize.isSingular = checkWord(irregularPlurals, irregularSingles, singularRules);\n\n    /**\n     * Add a pluralization rule to the collection.\n     *\n     * @param {(string|RegExp)} rule\n     * @param {string}          replacement\n     */\n    pluralize.addPluralRule = function (rule, replacement) {\n      pluralRules.push([sanitizeRule(rule), replacement]);\n    };\n\n    /**\n     * Add a singularization rule to the collection.\n     *\n     * @param {(string|RegExp)} rule\n     * @param {string}          replacement\n     */\n    pluralize.addSingularRule = function (rule, replacement) {\n      singularRules.push([sanitizeRule(rule), replacement]);\n    };\n\n    /**\n     * Add an uncountable word rule.\n     *\n     * @param {(string|RegExp)} word\n     */\n    pluralize.addUncountableRule = function (word) {\n      if (typeof word === 'string') {\n        uncountables[word.toLowerCase()] = true;\n        return;\n      }\n\n      // Set singular and plural references for the word.\n      pluralize.addPluralRule(word, '$0');\n      pluralize.addSingularRule(word, '$0');\n    };\n\n    /**\n     * Add an irregular word definition.\n     *\n     * @param {string} single\n     * @param {string} plural\n     */\n    pluralize.addIrregularRule = function (single, plural) {\n      plural = plural.toLowerCase();\n      single = single.toLowerCase();\n      irregularSingles[single] = plural;\n      irregularPlurals[plural] = single;\n    };\n\n    /**\n     * Irregular rules.\n     */\n    [\n    // Pronouns.\n    ['I', 'we'], ['me', 'us'], ['he', 'they'], ['she', 'they'], ['them', 'them'], ['myself', 'ourselves'], ['yourself', 'yourselves'], ['itself', 'themselves'], ['herself', 'themselves'], ['himself', 'themselves'], ['themself', 'themselves'], ['is', 'are'], ['was', 'were'], ['has', 'have'], ['this', 'these'], ['that', 'those'],\n    // Words ending in with a consonant and `o`.\n    ['echo', 'echoes'], ['dingo', 'dingoes'], ['volcano', 'volcanoes'], ['tornado', 'tornadoes'], ['torpedo', 'torpedoes'],\n    // Ends with `us`.\n    ['genus', 'genera'], ['viscus', 'viscera'],\n    // Ends with `ma`.\n    ['stigma', 'stigmata'], ['stoma', 'stomata'], ['dogma', 'dogmata'], ['lemma', 'lemmata'], ['schema', 'schemata'], ['anathema', 'anathemata'],\n    // Other irregular rules.\n    ['ox', 'oxen'], ['axe', 'axes'], ['die', 'dice'], ['yes', 'yeses'], ['foot', 'feet'], ['eave', 'eaves'], ['goose', 'geese'], ['tooth', 'teeth'], ['quiz', 'quizzes'], ['human', 'humans'], ['proof', 'proofs'], ['carve', 'carves'], ['valve', 'valves'], ['looey', 'looies'], ['thief', 'thieves'], ['groove', 'grooves'], ['pickaxe', 'pickaxes'], ['passerby', 'passersby']].forEach(function (rule) {\n      return pluralize.addIrregularRule(rule[0], rule[1]);\n    });\n\n    /**\n     * Pluralization rules.\n     */\n    [[/s?$/i, 's'], [/[^\\u0000-\\u007F]$/i, '$0'], [/([^aeiou]ese)$/i, '$1'], [/(ax|test)is$/i, '$1es'], [/(alias|[^aou]us|t[lm]as|gas|ris)$/i, '$1es'], [/(e[mn]u)s?$/i, '$1s'], [/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i, '$1'], [/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i, '$1i'], [/(alumn|alg|vertebr)(?:a|ae)$/i, '$1ae'], [/(seraph|cherub)(?:im)?$/i, '$1im'], [/(her|at|gr)o$/i, '$1oes'], [/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i, '$1a'], [/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i, '$1a'], [/sis$/i, 'ses'], [/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i, '$1$2ves'], [/([^aeiouy]|qu)y$/i, '$1ies'], [/([^ch][ieo][ln])ey$/i, '$1ies'], [/(x|ch|ss|sh|zz)$/i, '$1es'], [/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i, '$1ices'], [/\\b((?:tit)?m|l)(?:ice|ouse)$/i, '$1ice'], [/(pe)(?:rson|ople)$/i, '$1ople'], [/(child)(?:ren)?$/i, '$1ren'], [/eaux$/i, '$0'], [/m[ae]n$/i, 'men'], ['thou', 'you']].forEach(function (rule) {\n      return pluralize.addPluralRule(rule[0], rule[1]);\n    });\n\n    /**\n     * Singularization rules.\n     */\n    [[/s$/i, ''], [/(ss)$/i, '$1'], [/(wi|kni|(?:after|half|high|low|mid|non|night|[^\\w]|^)li)ves$/i, '$1fe'], [/(ar|(?:wo|[ae])l|[eo][ao])ves$/i, '$1f'], [/ies$/i, 'y'], [/\\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i, '$1ie'], [/\\b(mon|smil)ies$/i, '$1ey'], [/\\b((?:tit)?m|l)ice$/i, '$1ouse'], [/(seraph|cherub)im$/i, '$1'], [/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i, '$1'], [/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i, '$1sis'], [/(movie|twelve|abuse|e[mn]u)s$/i, '$1'], [/(test)(?:is|es)$/i, '$1is'], [/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i, '$1us'], [/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i, '$1um'], [/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i, '$1on'], [/(alumn|alg|vertebr)ae$/i, '$1a'], [/(cod|mur|sil|vert|ind)ices$/i, '$1ex'], [/(matr|append)ices$/i, '$1ix'], [/(pe)(rson|ople)$/i, '$1rson'], [/(child)ren$/i, '$1'], [/(eau)x?$/i, '$1'], [/men$/i, 'man']].forEach(function (rule) {\n      return pluralize.addSingularRule(rule[0], rule[1]);\n    });\n\n    /**\n     * Uncountable rules.\n     */\n    [\n    // Singular words with no plurals.\n    'adulthood', 'advice', 'agenda', 'aid', 'aircraft', 'alcohol', 'ammo', 'analytics', 'anime', 'athletics', 'audio', 'bison', 'blood', 'bream', 'buffalo', 'butter', 'carp', 'cash', 'chassis', 'chess', 'clothing', 'cod', 'commerce', 'cooperation', 'corps', 'debris', 'diabetes', 'digestion', 'elk', 'energy', 'equipment', 'excretion', 'expertise', 'firmware', 'flounder', 'fun', 'gallows', 'garbage', 'graffiti', 'hardware', 'headquarters', 'health', 'herpes', 'highjinks', 'homework', 'housework', 'information', 'jeans', 'justice', 'kudos', 'labour', 'literature', 'machinery', 'mackerel', 'mail', 'media', 'mews', 'moose', 'music', 'mud', 'manga', 'news', 'only', 'personnel', 'pike', 'plankton', 'pliers', 'police', 'pollution', 'premises', 'rain', 'research', 'rice', 'salmon', 'scissors', 'series', 'sewage', 'shambles', 'shrimp', 'software', 'species', 'staff', 'swine', 'tennis', 'traffic', 'transportation', 'trout', 'tuna', 'wealth', 'welfare', 'whiting', 'wildebeest', 'wildlife', 'you', /pok[eé]mon$/i,\n    // Regexes.\n    /[^aeiou]ese$/i,\n    // \"chinese\", \"japanese\"\n    /deer$/i,\n    // \"deer\", \"reindeer\"\n    /fish$/i,\n    // \"fish\", \"blowfish\", \"angelfish\"\n    /measles$/i, /o[iu]s$/i,\n    // \"carnivorous\"\n    /pox$/i,\n    // \"chickpox\", \"smallpox\"\n    /sheep$/i].forEach(pluralize.addUncountableRule);\n    return pluralize;\n  });\n});\nfunction deflateHelper(store, data) {\n  function deflate(data) {\n    if (!data || typeof data !== \"object\") {\n      return data;\n    }\n    if (Array.isArray(data)) {\n      return data.map(deflate);\n    }\n    var __typename = data.__typename;\n    var id = data.id;\n    if (__typename && store.isRootType(__typename)) {\n      // GQL object with root type, keep only __typename & id\n      return {\n        __typename: __typename,\n        id: id\n      };\n    } else {\n      // GQL object with non-root type, return object with all props deflated\n      var snapshot = {};\n      for (var key in data) {\n        snapshot[key] = deflate(data[key]);\n      }\n      return snapshot;\n    }\n  }\n  return deflate(data);\n}\nfunction mergeHelper(store, data) {\n  function merge(data) {\n    if (!data || typeof data !== \"object\") {\n      return data;\n    }\n    if (Array.isArray(data)) {\n      return data.map(merge);\n    }\n    var __typename = data.__typename;\n    var id = data.id; // convert values deeply first to MST objects as much as possible\n\n    var snapshot = {};\n    for (var key in data) {\n      snapshot[key] = merge(data[key]);\n    } // GQL object\n\n    if (__typename && store.isKnownType(__typename)) {\n      // GQL object with known type, instantiate or recycle MST object\n      var typeDef = store.getTypeDef(__typename); // Try to reuse instance, even if it is not a root type\n\n      var instance = id !== undefined && resolveIdentifier(typeDef, store, id);\n      if (instance) {\n        // update existing object\n        Object.assign(instance, snapshot);\n      } else {\n        // create a new one\n        instance = typeDef.create(snapshot);\n        if (store.isRootType(__typename)) {\n          // register in the store if a root\n          //store[typenameToCollectionName(__typename)].set(id, instance)\n          store[store.getCollectionName(__typename)].set(id, instance);\n        }\n        instance.__setStore(store);\n      }\n      return instance;\n    } else {\n      // GQL object with unknown type, return verbatim\n      return snapshot;\n    }\n  }\n  return merge(data);\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\nvar fastJsonStableStringify = function (data, opts) {\n  if (!opts) opts = {};\n  if (typeof opts === 'function') opts = {\n    cmp: opts\n  };\n  var cycles = typeof opts.cycles === 'boolean' ? opts.cycles : false;\n  var cmp = opts.cmp && function (f) {\n    return function (node) {\n      return function (a, b) {\n        var aobj = {\n          key: a,\n          value: node[a]\n        };\n        var bobj = {\n          key: b,\n          value: node[b]\n        };\n        return f(aobj, bobj);\n      };\n    };\n  }(opts.cmp);\n  var seen = [];\n  return function stringify(node) {\n    if (node && node.toJSON && typeof node.toJSON === 'function') {\n      node = node.toJSON();\n    }\n    if (node === undefined) return;\n    if (typeof node == 'number') return isFinite(node) ? '' + node : 'null';\n    if (typeof node !== 'object') return JSON.stringify(node);\n    var i, out;\n    if (Array.isArray(node)) {\n      out = '[';\n      for (i = 0; i < node.length; i++) {\n        if (i) out += ',';\n        out += stringify(node[i]) || 'null';\n      }\n      return out + ']';\n    }\n    if (node === null) return 'null';\n    if (seen.indexOf(node) !== -1) {\n      if (cycles) return JSON.stringify('__cycle__');\n      throw new TypeError('Converting circular structure to JSON');\n    }\n    var seenIndex = seen.push(node) - 1;\n    var keys = Object.keys(node).sort(cmp && cmp(node));\n    out = '';\n    for (i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = stringify(node[key]);\n      if (!value) continue;\n      if (out) out += ',';\n      out += JSON.stringify(key) + ':' + value;\n    }\n    seen.splice(seenIndex, 1);\n    return '{' + out + '}';\n  }(data);\n};\nvar isServer = typeof window === \"undefined\";\nvar Query = function Query(store, query, variables, options) {\n  var this$1 = this;\n  if (options === void 0) options = {};\n  this.store = store;\n  this.variables = variables;\n  this.options = options;\n  this.loading = false;\n  this.data = undefined;\n  this.error = undefined;\n  this.refetch = function () {\n    return Promise.resolve().then(action(function () {\n      if (!this$1.loading) {\n        this$1.fetchResults();\n      }\n      return this$1.promise;\n    }));\n  };\n  this.query = typeof query === \"string\" ? query : print(query);\n  this.queryKey = this.query + fastJsonStableStringify(variables);\n  var fetchPolicy = options.fetchPolicy || \"cache-and-network\";\n  if (this.store.ssr && !this.options.noSsr && (isServer || !store.__afterInit)) {\n    fetchPolicy = \"cache-first\";\n  }\n  this.fetchPolicy = fetchPolicy;\n  if (this.store.ssr && this.options.noSsr && isServer) {\n    this.promise = Promise.resolve();\n    return;\n  }\n  var inCache = this.store.__queryCache.has(this.queryKey);\n  switch (this.fetchPolicy) {\n    case \"no-cache\":\n    case \"network-only\":\n      this.fetchResults();\n      break;\n    case \"cache-only\":\n      if (!inCache) {\n        this.error = new Error(\"No results for query \" + this.query + \" found in cache, and policy is cache-only\");\n        this.promise = Promise.reject(this.error);\n      } else {\n        this.useCachedResults();\n      }\n      break;\n    case \"cache-and-network\":\n      if (inCache) {\n        this.useCachedResults();\n        this.refetch(); // refetch async, so that callers chaining to the initial promise should resovle immediately!\n      } else {\n        this.fetchResults();\n      }\n      break;\n    case \"cache-first\":\n      if (inCache) {\n        this.useCachedResults();\n      } else {\n        this.fetchResults();\n      }\n      break;\n  }\n};\nQuery.prototype.fetchResults = function fetchResults() {\n  var this$1 = this;\n  this.loading = true;\n  var promise;\n  var existingPromise = this.store.__promises.get(this.queryKey);\n  if (existingPromise) {\n    promise = existingPromise;\n  } else {\n    promise = this.store.rawRequest(this.query, this.variables);\n    this.store.__pushPromise(promise, this.queryKey);\n  }\n  promise = promise.then(function (data) {\n    // cache query and response\n    if (this$1.fetchPolicy !== \"no-cache\") {\n      this$1.store.__cacheResponse(this$1.queryKey, this$1.store.deflate(data));\n    }\n    return this$1.store.merge(data);\n  });\n  this.promise = promise;\n  promise.then(action(function (data) {\n    this$1.loading = false;\n    this$1.error = false;\n    this$1.data = data;\n  }), action(function (error) {\n    this$1.loading = false;\n    this$1.error = error;\n  }));\n};\nQuery.prototype.useCachedResults = function useCachedResults() {\n  this.data = this.store.merge(this.store.__queryCache.get(this.queryKey));\n  this.promise = Promise.resolve(this.data);\n};\nQuery.prototype.case = function case$1(handlers) {\n  return this.loading && !this.data ? handlers.loading() : this.error ? handlers.error(this.error) : handlers.data(this.data);\n};\nQuery.prototype.currentPromise = function currentPromise() {\n  return this.promise;\n};\nQuery.prototype.then = function then(onfulfilled, onrejected) {\n  var this$1 = this;\n  return this.promise.then(function (d) {\n    this$1.store.__runInStoreContext(function () {\n      return onfulfilled(d);\n    });\n  }, function (e) {\n    this$1.store.__runInStoreContext(function () {\n      return onrejected(e);\n    });\n  });\n};\n__decorate([observable], Query.prototype, \"loading\", void 0);\n__decorate([observable.ref], Query.prototype, \"data\", void 0);\n__decorate([observable], Query.prototype, \"error\", void 0);\nfunction getFirstValue(data) {\n  var keys = Object.keys(data);\n  if (keys.length !== 1) {\n    throw new Error(\"Expected exactly one response key, got: \" + keys.join(\", \"));\n  }\n  return data[keys[0]];\n}\nvar MSTGQLStore = types.model(\"MSTGQLStore\", {\n  __queryCache: types.optional(types.map(types.frozen()), {})\n}).volatile(function (self) {\n  var ref = getEnv(self);\n  var ssr = ref.ssr;\n  if (ssr === void 0) ssr = false;\n  return {\n    ssr: ssr,\n    __promises: new Map(),\n    __afterInit: false\n  };\n}).actions(function (self) {\n  Promise.resolve().then(function () {\n    return self.__onAfterInit();\n  });\n  var ref = getEnv(self);\n  var gqlHttpClient = ref.gqlHttpClient;\n  var gqlWsClient = ref.gqlWsClient;\n  if (!gqlHttpClient && !gqlWsClient) {\n    throw new Error(\"Either gqlHttpClient or gqlWsClient (or both) should provided in the MSTGQLStore environment\");\n  }\n  function merge(data) {\n    return mergeHelper(self, data);\n  }\n  function deflate(data) {\n    return deflateHelper(self, data);\n  }\n  function rawRequest(query, variables) {\n    if (gqlHttpClient) {\n      return gqlHttpClient.request(query, variables);\n    } else {\n      return new Promise(function (resolve, reject) {\n        gqlWsClient.request({\n          query: query,\n          variables: variables\n        }).subscribe({\n          next: function next(data) {\n            resolve(data.data);\n          },\n          error: reject\n        });\n      });\n    }\n  }\n  function query(query, variables, options) {\n    if (options === void 0) options = {};\n    return new Query(self, query, variables, options);\n  }\n  function mutate(mutation, variables, optimisticUpdate) {\n    if (optimisticUpdate) {\n      var recorder = recordPatches(self);\n      optimisticUpdate();\n      recorder.stop();\n      var q = query(mutation, variables, {\n        fetchPolicy: \"network-only\"\n      });\n      q.currentPromise().catch(function () {\n        recorder.undo();\n      });\n      return q;\n    } else {\n      return query(mutation, variables, {\n        fetchPolicy: \"network-only\"\n      });\n    }\n  } // N.b: the T is ignored, but it does simplify code generation\n\n  function subscribe(query, variables, onData, onError) {\n    if (onError === void 0) onError = function (error) {\n      throw error;\n    };\n    if (!gqlWsClient) {\n      throw new Error(\"No WS client available\");\n    }\n    var sub = gqlWsClient.request({\n      query: query,\n      variables: variables\n    }).subscribe({\n      next: function next(data) {\n        if (data.errors) {\n          return onError(new Error(JSON.stringify(data.errors)));\n        }\n        self.__runInStoreContext(function () {\n          var res = self.merge(getFirstValue(data.data));\n          if (onData) {\n            onData(res);\n          }\n          return res;\n        });\n      }\n    });\n    return function () {\n      return sub.unsubscribe();\n    };\n  } // exposed actions\n\n  return {\n    merge: merge,\n    deflate: deflate,\n    mutate: mutate,\n    query: query,\n    subscribe: subscribe,\n    rawRequest: rawRequest,\n    __pushPromise: function __pushPromise(promise, queryKey) {\n      self.__promises.set(queryKey, promise);\n      var onSettled = function () {\n        return self.__promises.delete(queryKey);\n      };\n      promise.then(onSettled, onSettled);\n    },\n    __runInStoreContext: function __runInStoreContext(fn) {\n      return fn();\n    },\n    __cacheResponse: function __cacheResponse(key, response) {\n      self.__queryCache.set(key, response);\n    },\n    __onAfterInit: function __onAfterInit() {\n      self.__afterInit = true;\n    }\n  };\n});\nfunction configureStoreMixin(knownTypes, rootTypes, namingConvention) {\n  var kt = new Map();\n  var rt = new Set(rootTypes);\n  return function () {\n    return {\n      actions: {\n        afterCreate: function afterCreate() {\n          // initialized lazily, so that there are no circular dep issues\n          knownTypes.forEach(function (ref) {\n            var key = ref[0];\n            var typeFn = ref[1];\n            var type = typeFn();\n            if (!type) {\n              throw new Error(\"The type provided for '\" + key + \"' is empty. Probably this is a module loading issue\");\n            }\n            kt.set(key, type);\n          });\n        }\n      },\n      views: {\n        isKnownType: function isKnownType(typename) {\n          return kt.has(typename);\n        },\n        isRootType: function isRootType(typename) {\n          return rt.has(typename);\n        },\n        getTypeDef: function getTypeDef(typename) {\n          return kt.get(typename);\n        },\n        getCollectionName: function getCollectionName(typename) {\n          if (namingConvention == \"js\") {\n            // Pluralize only last word (pluralize may fail with words that are\n            // not valid English words as is the case with LongCamelCaseTypeNames)\n            var newName = camelcase(typename);\n            var parts = newName.split(/(?=[A-Z])/);\n            parts[parts.length - 1] = pluralize(parts[parts.length - 1]);\n            return parts.join(\"\");\n          }\n          return typename.toLowerCase() + \"s\";\n        }\n      }\n    };\n  };\n}\n\n/*\r\n For detached objects (objects that are not part of the Roots, or one of their children, for example: query results),\r\n we cannot use the default resolution mechanism, since they are not part of the store. So, first fetch the store and resolve from there\r\n*/\n\nfunction MSTGQLRef(targetType) {\n  return types.reference(targetType, {\n    get: function get(id, parent) {\n      var node = resolveIdentifier(targetType, parent.store || getParent(parent).store, id);\n      if (!node) {\n        throw new Error(\"Failed to resolve reference \" + id + \" to \" + targetType.name);\n      }\n      return node;\n    },\n    set: function set(value) {\n      return value.id;\n    }\n  });\n}\nvar MSTGQLObject = types.model(\"MSTGQLObject\").extend(function (self) {\n  var store;\n  function getStore() {\n    return store || (store = getParent(self, 2));\n  }\n  return {\n    actions: {\n      __setStore: function __setStore(s) {\n        store = s;\n      }\n    },\n    views: {\n      __getStore: function __getStore() {\n        return getStore();\n      },\n      hasLoaded: function hasLoaded(key) {\n        return typeof self[key] !== \"undefined\";\n      }\n    }\n  };\n});\nfunction createHttpClient(url, options) {\n  if (options === void 0) options = {};\n  return new GraphQLClient(url, options);\n}\nvar QueryBuilder = function QueryBuilder() {\n  this.__query = \"\";\n  this.__attr(\"__typename\");\n  if (typeof this.id === \"function\") {\n    this.id();\n  }\n};\nQueryBuilder.prototype.__attr = function __attr(attr) {\n  return this._(attr);\n}; // raw is exposed, to be able to add free form gql in the middle\n\nQueryBuilder.prototype._ = function _(str) {\n  this.__query += str + \"\\n\"; // TODO: restore depth / formatting by passing base depth to constructor: ${\"\".padStart(this.__qb.stack.length * 2)}\n\n  return this;\n};\nQueryBuilder.prototype.__child = function __child(childName, childType, builder) {\n  this._(childName + \" {\\n\");\n  this.__buildChild(childType, builder);\n  this._(\"}\");\n  return this;\n}; // used for interfaces and unions\n\nQueryBuilder.prototype.__inlineFragment = function __inlineFragment(childName, childType, builder) {\n  this._(\"... on \" + childName + \" {\\n\");\n  this.__buildChild(childType, builder);\n  this._(\"}\");\n  return this;\n};\nQueryBuilder.prototype.__buildChild = function __buildChild(childType, builder) {\n  // already instantiated child builder\n  if (builder instanceof QueryBuilder) {\n    this._(builder.toString());\n  } else {\n    var childBuilder = new childType();\n    if (typeof builder === \"string\") {\n      childBuilder._(builder);\n    } else if (typeof builder === \"function\") {\n      builder(childBuilder);\n    } // undefined is ok as well, no fields at all\n\n    this._(childBuilder.toString());\n  }\n};\nQueryBuilder.prototype.toString = function toString() {\n  return this.__query;\n};\n\n/* eslint-disable no-undefined,no-param-reassign,no-shadow */\n\n/**\n * Throttle execution of a function. Especially useful for rate limiting\n * execution of handlers on events like resize and scroll.\n *\n * @param  {Number}    delay          A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {Boolean}   [noTrailing]   Optional, defaults to false. If noTrailing is true, callback will only execute every `delay` milliseconds while the\n *                                    throttled-function is being called. If noTrailing is false or unspecified, callback will be executed one final time\n *                                    after the last throttled-function call. (After the throttled-function has not been called for `delay` milliseconds,\n *                                    the internal counter is reset)\n * @param  {Function}  callback       A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                    to `callback` when the throttled-function is executed.\n * @param  {Boolean}   [debounceMode] If `debounceMode` is true (at begin), schedule `clear` to execute after `delay` ms. If `debounceMode` is false (at end),\n *                                    schedule `callback` to execute after `delay` ms.\n *\n * @return {Function}  A new, throttled, function.\n */\nfunction throttle(delay, noTrailing, callback, debounceMode) {\n  /*\n   * After wrapper has stopped being called, this timeout ensures that\n   * `callback` is executed at the proper times in `throttle` and `end`\n   * debounce modes.\n   */\n  var timeoutID;\n  var cancelled = false; // Keep track of the last time `callback` was executed.\n\n  var lastExec = 0; // Function to clear existing timeout\n\n  function clearExistingTimeout() {\n    if (timeoutID) {\n      clearTimeout(timeoutID);\n    }\n  } // Function to cancel next exec\n\n  function cancel() {\n    clearExistingTimeout();\n    cancelled = true;\n  } // `noTrailing` defaults to falsy.\n\n  if (typeof noTrailing !== 'boolean') {\n    debounceMode = callback;\n    callback = noTrailing;\n    noTrailing = undefined;\n  }\n  /*\n   * The `wrapper` function encapsulates all of the throttling / debouncing\n   * functionality and when executed will limit the rate at which `callback`\n   * is executed.\n   */\n\n  function wrapper() {\n    var self = this;\n    var elapsed = Date.now() - lastExec;\n    var args = arguments;\n    if (cancelled) {\n      return;\n    } // Execute `callback` and update the `lastExec` timestamp.\n\n    function exec() {\n      lastExec = Date.now();\n      callback.apply(self, args);\n    }\n    /*\n     * If `debounceMode` is true (at begin) this is used to clear the flag\n     * to allow future `callback` executions.\n     */\n\n    function clear() {\n      timeoutID = undefined;\n    }\n    if (debounceMode && !timeoutID) {\n      /*\n       * Since `wrapper` is being called for the first time and\n       * `debounceMode` is true (at begin), execute `callback`.\n       */\n      exec();\n    }\n    clearExistingTimeout();\n    if (debounceMode === undefined && elapsed > delay) {\n      /*\n       * In throttle mode, if `delay` time has been exceeded, execute\n       * `callback`.\n       */\n      exec();\n    } else if (noTrailing !== true) {\n      /*\n       * In trailing throttle mode, since `delay` time has not been\n       * exceeded, schedule `callback` to execute `delay` ms after most\n       * recent execution.\n       *\n       * If `debounceMode` is true (at begin), schedule `clear` to execute\n       * after `delay` ms.\n       *\n       * If `debounceMode` is false (at end), schedule `callback` to\n       * execute after `delay` ms.\n       */\n      timeoutID = setTimeout(debounceMode ? clear : exec, debounceMode === undefined ? delay - elapsed : delay);\n    }\n  }\n  wrapper.cancel = cancel; // Return the wrapper function.\n\n  return wrapper;\n}\nfunction localStorageMixin(options) {\n  if (options === void 0) options = {};\n  var storage = options.storage || window.localStorage;\n  var throttleInterval = options.throttle || 5000;\n  var storageKey = options.storageKey || \"mst-gql-rootstore\";\n  return function (self) {\n    return {\n      actions: {\n        afterCreate: function () {\n          try {\n            return Promise.resolve(storage.getItem(storageKey)).then(function (data) {\n              if (data) {\n                var json = JSON.parse(data);\n                var selfType = getType(self);\n                if (!selfType.is(json)) {\n                  console.warn(\"Data in local storage does not conform the data shape specified by \" + selfType.name + \", ignoring the stored data\");\n                  return;\n                }\n                applySnapshot(self, json);\n              }\n              addDisposer(self, onSnapshot(self, throttle(throttleInterval, function (data) {\n                storage.setItem(storageKey, JSON.stringify(data));\n              })));\n            });\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }\n      }\n    };\n  };\n}\n\n// A type of promise-like that resolves synchronously and supports only one observer\nconst _Pact = /*#__PURE__*/function () {\n  function _Pact() {}\n  _Pact.prototype.then = function (onFulfilled, onRejected) {\n    const result = new _Pact();\n    const state = this.s;\n    if (state) {\n      const callback = state & 1 ? onFulfilled : onRejected;\n      if (callback) {\n        try {\n          _settle(result, 1, callback(this.v));\n        } catch (e) {\n          _settle(result, 2, e);\n        }\n        return result;\n      } else {\n        return this;\n      }\n    }\n    this.o = function (_this) {\n      try {\n        const value = _this.v;\n        if (_this.s & 1) {\n          _settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n        } else if (onRejected) {\n          _settle(result, 1, onRejected(value));\n        } else {\n          _settle(result, 2, value);\n        }\n      } catch (e) {\n        _settle(result, 2, e);\n      }\n    };\n    return result;\n  };\n  return _Pact;\n}();\n\n// Settles a pact synchronously\nfunction _settle(pact, state, value) {\n  if (!pact.s) {\n    if (value instanceof _Pact) {\n      if (value.s) {\n        if (state & 1) {\n          state = value.s;\n        }\n        value = value.v;\n      } else {\n        value.o = _settle.bind(null, pact, state);\n        return;\n      }\n    }\n    if (value && value.then) {\n      value.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n      return;\n    }\n    pact.s = state;\n    pact.v = value;\n    const observer = pact.o;\n    if (observer) {\n      observer(pact);\n    }\n  }\n}\nfunction _isSettledPact(thenable) {\n  return thenable instanceof _Pact && thenable.s & 1;\n}\nconst _iteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\")) : \"@@iterator\";\nconst _asyncIteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\")) : \"@@asyncIterator\";\n\n// Asynchronously implement a generic for loop\nfunction _for(test, update, body) {\n  var stage;\n  for (;;) {\n    var shouldContinue = test();\n    if (_isSettledPact(shouldContinue)) {\n      shouldContinue = shouldContinue.v;\n    }\n    if (!shouldContinue) {\n      return result;\n    }\n    if (shouldContinue.then) {\n      stage = 0;\n      break;\n    }\n    var result = body();\n    if (result && result.then) {\n      if (_isSettledPact(result)) {\n        result = result.s;\n      } else {\n        stage = 1;\n        break;\n      }\n    }\n    if (update) {\n      var updateValue = update();\n      if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n        stage = 2;\n        break;\n      }\n    }\n  }\n  var pact = new _Pact();\n  var reject = _settle.bind(null, pact, 2);\n  (stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n  return pact;\n  function _resumeAfterBody(value) {\n    result = value;\n    do {\n      if (update) {\n        updateValue = update();\n        if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n          updateValue.then(_resumeAfterUpdate).then(void 0, reject);\n          return;\n        }\n      }\n      shouldContinue = test();\n      if (!shouldContinue || _isSettledPact(shouldContinue) && !shouldContinue.v) {\n        _settle(pact, 1, result);\n        return;\n      }\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n        return;\n      }\n      result = body();\n      if (_isSettledPact(result)) {\n        result = result.v;\n      }\n    } while (!result || !result.then);\n    result.then(_resumeAfterBody).then(void 0, reject);\n  }\n  function _resumeAfterTest(shouldContinue) {\n    if (shouldContinue) {\n      result = body();\n      if (result && result.then) {\n        result.then(_resumeAfterBody).then(void 0, reject);\n      } else {\n        _resumeAfterBody(result);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n  function _resumeAfterUpdate() {\n    if (shouldContinue = test()) {\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n      } else {\n        _resumeAfterTest(shouldContinue);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n}\nvar getDataFromTree = function (tree, client, renderFunction) {\n  try {\n    var _exit = false;\n    if (renderFunction === undefined) {\n      renderFunction = require(\"react-dom/server\").renderToStaticMarkup;\n    }\n    return Promise.resolve(_for(function () {\n      return !_exit;\n    }, void 0, function () {\n      var html = renderFunction(tree);\n      if (client.__promises.size === 0) {\n        _exit = true;\n        return html;\n      }\n      return Promise.resolve(Promise.all(client.__promises.values())).then(function () {});\n    }));\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\nfunction createStoreContext(React) {\n  return React.createContext(null);\n}\nfunction normalizeQuery(store, query, ref) {\n  var variables = ref.variables;\n  var fetchPolicy = ref.fetchPolicy;\n  if (fetchPolicy === void 0) fetchPolicy = \"cache-and-network\";\n  if (typeof query === \"function\") {\n    return query(store);\n  }\n  if (query instanceof Query) {\n    return query;\n  }\n  return store.query(query, variables, {\n    fetchPolicy: fetchPolicy\n  });\n}\nfunction createUseQueryHook(context, React) {\n  return function (queryIn, opts) {\n    if (queryIn === void 0) queryIn = undefined;\n    if (opts === void 0) opts = {};\n    var store = opts && opts.store || React.useContext(context); // const prevData = useRef<DATA>() // TODO: is this useful?\n\n    var ref = React.useState(function () {\n      if (!queryIn) {\n        return undefined;\n      }\n      return normalizeQuery(store, queryIn, opts);\n    });\n    var query = ref[0];\n    var setQuery = ref[1];\n    var setQueryHelper = React.useCallback(function (newQuery) {\n      // if the current query had results already, save it in prevData\n      // if (query && query.data) prevData.current = query.data\n      setQuery(normalizeQuery(store, newQuery, opts));\n    }, []); // if new query or variables are passed in, replace the query!\n\n    React.useEffect(function () {\n      if (!queryIn || typeof queryIn === \"function\") {\n        return;\n      } // ignore changes to initializer func\n\n      setQueryHelper(queryIn);\n    }, [queryIn, opts.fetchPolicy, JSON.stringify(opts.variables)]); // TODO: use a decent deep equal\n\n    return {\n      store: store,\n      loading: query ? query.loading : false,\n      error: query && query.error,\n      data: query && query.data,\n      // prevData: prevData.current,\n      query: query,\n      setQuery: setQueryHelper\n    };\n  };\n}\nfunction withTypedRefs() {\n  return function (model) {\n    return model;\n  };\n}\nexport { MSTGQLStore, configureStoreMixin, Query, MSTGQLObject, MSTGQLRef, createHttpClient, QueryBuilder, localStorageMixin, getDataFromTree, createStoreContext, createUseQueryHook, withTypedRefs };","map":{"version":3,"names":["preserveCamelCase","string","isLastCharLower","isLastCharUpper","isLastLastCharUpper","i","length","character","test","toUpperCase","slice","toLowerCase","camelCase","input","options","Array","isArray","TypeError","Object","assign","pascalCase","postProcess","x","charAt","map","trim","filter","join","hasUpperCase","replace","_","p1","m","camelcase","default_1","root","pluralize","commonjsRequire","module","exports","commonjsGlobal","pluralRules","singularRules","uncountables","irregularPlurals","irregularSingles","sanitizeRule","rule","RegExp","restoreCase","word","token","substr","interpolate","str","args","match","index","result","arguments","sanitizeWord","rules","hasOwnProperty","len","replaceWord","replaceMap","keepMap","checkWord","bool","count","inclusive","pluralized","singular","plural","isPlural","isSingular","addPluralRule","replacement","push","addSingularRule","addUncountableRule","addIrregularRule","single","forEach","deflateHelper","store","data","deflate","__typename","id","isRootType","snapshot","key","mergeHelper","merge","isKnownType","typeDef","getTypeDef","instance","undefined","resolveIdentifier","create","getCollectionName","set","__setStore","__decorate","decorators","target","desc","c","r","getOwnPropertyDescriptor","d","Reflect","decorate","defineProperty","fastJsonStableStringify","opts","cmp","cycles","f","node","a","b","aobj","value","bobj","seen","stringify","toJSON","isFinite","JSON","out","indexOf","seenIndex","keys","sort","splice","isServer","window","Query","query","variables","Promise","resolve","then","action","this$1","loading","fetchResults","promise","print","queryKey","fetchPolicy","ssr","noSsr","__afterInit","inCache","__queryCache","has","error","Error","reject","useCachedResults","refetch","existingPromise","__promises","get","rawRequest","__pushPromise","__cacheResponse","case","case$1","handlers","currentPromise","onfulfilled","onrejected","__runInStoreContext","e","observable","prototype","ref","getFirstValue","MSTGQLStore","types","model","optional","frozen","volatile","self","getEnv","Map","actions","__onAfterInit","gqlHttpClient","gqlWsClient","request","subscribe","next","mutate","mutation","optimisticUpdate","recorder","recordPatches","stop","q","catch","undo","onData","onError","sub","errors","res","unsubscribe","onSettled","delete","fn","response","configureStoreMixin","knownTypes","rootTypes","namingConvention","kt","rt","Set","afterCreate","type","typeFn","views","typename","newName","parts","split","MSTGQLRef","targetType","reference","parent","getParent","name","MSTGQLObject","extend","getStore","s","__getStore","hasLoaded","createHttpClient","url","GraphQLClient","QueryBuilder","__attr","attr","__query","__child","childName","childType","builder","__buildChild","__inlineFragment","toString","childBuilder","throttle","delay","noTrailing","callback","debounceMode","timeoutID","cancelled","lastExec","clearExistingTimeout","clearTimeout","cancel","wrapper","elapsed","Date","now","exec","apply","clear","setTimeout","localStorageMixin","storage","localStorage","throttleInterval","storageKey","getItem","json","parse","selfType","getType","is","console","warn","applySnapshot","addDisposer","onSnapshot","setItem","_Pact","onFulfilled","onRejected","state","_settle","v","o","_this","pact","bind","observer","_isSettledPact","thenable","_iteratorSymbol","Symbol","iterator","_asyncIteratorSymbol","asyncIterator","_for","update","body","stage","shouldContinue","updateValue","_resumeAfterTest","_resumeAfterBody","_resumeAfterUpdate","getDataFromTree","tree","client","renderFunction","require","renderToStaticMarkup","html","size","all","values","createStoreContext","React","createContext","normalizeQuery","createUseQueryHook","context","queryIn","useContext","useState","setQuery","setQueryHelper","useCallback","newQuery","useEffect","withTypedRefs"],"sources":["../node_modules/camelcase/index.js","../node_modules/pluralize/pluralize.js","../src/deflateHelper.ts","../src/mergeHelper.ts","../node_modules/tslib/tslib.es6.js","../node_modules/fast-json-stable-stringify/index.js","../src/Query.ts","../src/utils.ts","../src/MSTGQLStore.ts","../src/MSTGQLObject.ts","../src/createHttpClient.ts","../src/queryBuilder.ts","../node_modules/throttle-debounce/dist/index.esm.js","../src/localStorageMixin.ts","../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../src/react.tsx","../src/withTypedRefs.ts"],"sourcesContent":["'use strict';\n\nconst preserveCamelCase = string => {\n\tlet isLastCharLower = false;\n\tlet isLastCharUpper = false;\n\tlet isLastLastCharUpper = false;\n\n\tfor (let i = 0; i < string.length; i++) {\n\t\tconst character = string[i];\n\n\t\tif (isLastCharLower && /[a-zA-Z]/.test(character) && character.toUpperCase() === character) {\n\t\t\tstring = string.slice(0, i) + '-' + string.slice(i);\n\t\t\tisLastCharLower = false;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = true;\n\t\t\ti++;\n\t\t} else if (isLastCharUpper && isLastLastCharUpper && /[a-zA-Z]/.test(character) && character.toLowerCase() === character) {\n\t\t\tstring = string.slice(0, i - 1) + '-' + string.slice(i - 1);\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = false;\n\t\t\tisLastCharLower = true;\n\t\t} else {\n\t\t\tisLastCharLower = character.toLowerCase() === character && character.toUpperCase() !== character;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = character.toUpperCase() === character && character.toLowerCase() !== character;\n\t\t}\n\t}\n\n\treturn string;\n};\n\nconst camelCase = (input, options) => {\n\tif (!(typeof input === 'string' || Array.isArray(input))) {\n\t\tthrow new TypeError('Expected the input to be `string | string[]`');\n\t}\n\n\toptions = Object.assign({\n\t\tpascalCase: false\n\t}, options);\n\n\tconst postProcess = x => options.pascalCase ? x.charAt(0).toUpperCase() + x.slice(1) : x;\n\n\tif (Array.isArray(input)) {\n\t\tinput = input.map(x => x.trim())\n\t\t\t.filter(x => x.length)\n\t\t\t.join('-');\n\t} else {\n\t\tinput = input.trim();\n\t}\n\n\tif (input.length === 0) {\n\t\treturn '';\n\t}\n\n\tif (input.length === 1) {\n\t\treturn options.pascalCase ? input.toUpperCase() : input.toLowerCase();\n\t}\n\n\tconst hasUpperCase = input !== input.toLowerCase();\n\n\tif (hasUpperCase) {\n\t\tinput = preserveCamelCase(input);\n\t}\n\n\tinput = input\n\t\t.replace(/^[_.\\- ]+/, '')\n\t\t.toLowerCase()\n\t\t.replace(/[_.\\- ]+(\\w|$)/g, (_, p1) => p1.toUpperCase())\n\t\t.replace(/\\d+(\\w|$)/g, m => m.toUpperCase());\n\n\treturn postProcess(input);\n};\n\nmodule.exports = camelCase;\n// TODO: Remove this for the next major release\nmodule.exports.default = camelCase;\n","/* global define */\n\n(function (root, pluralize) {\n  /* istanbul ignore else */\n  if (typeof require === 'function' && typeof exports === 'object' && typeof module === 'object') {\n    // Node.\n    module.exports = pluralize();\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD, registers as an anonymous module.\n    define(function () {\n      return pluralize();\n    });\n  } else {\n    // Browser global.\n    root.pluralize = pluralize();\n  }\n})(this, function () {\n  // Rule storage - pluralize and singularize need to be run sequentially,\n  // while other rules can be optimized using an object for instant lookups.\n  var pluralRules = [];\n  var singularRules = [];\n  var uncountables = {};\n  var irregularPlurals = {};\n  var irregularSingles = {};\n\n  /**\n   * Sanitize a pluralization rule to a usable regular expression.\n   *\n   * @param  {(RegExp|string)} rule\n   * @return {RegExp}\n   */\n  function sanitizeRule (rule) {\n    if (typeof rule === 'string') {\n      return new RegExp('^' + rule + '$', 'i');\n    }\n\n    return rule;\n  }\n\n  /**\n   * Pass in a word token to produce a function that can replicate the case on\n   * another word.\n   *\n   * @param  {string}   word\n   * @param  {string}   token\n   * @return {Function}\n   */\n  function restoreCase (word, token) {\n    // Tokens are an exact match.\n    if (word === token) return token;\n\n    // Lower cased words. E.g. \"hello\".\n    if (word === word.toLowerCase()) return token.toLowerCase();\n\n    // Upper cased words. E.g. \"WHISKY\".\n    if (word === word.toUpperCase()) return token.toUpperCase();\n\n    // Title cased words. E.g. \"Title\".\n    if (word[0] === word[0].toUpperCase()) {\n      return token.charAt(0).toUpperCase() + token.substr(1).toLowerCase();\n    }\n\n    // Lower cased words. E.g. \"test\".\n    return token.toLowerCase();\n  }\n\n  /**\n   * Interpolate a regexp string.\n   *\n   * @param  {string} str\n   * @param  {Array}  args\n   * @return {string}\n   */\n  function interpolate (str, args) {\n    return str.replace(/\\$(\\d{1,2})/g, function (match, index) {\n      return args[index] || '';\n    });\n  }\n\n  /**\n   * Replace a word using a rule.\n   *\n   * @param  {string} word\n   * @param  {Array}  rule\n   * @return {string}\n   */\n  function replace (word, rule) {\n    return word.replace(rule[0], function (match, index) {\n      var result = interpolate(rule[1], arguments);\n\n      if (match === '') {\n        return restoreCase(word[index - 1], result);\n      }\n\n      return restoreCase(match, result);\n    });\n  }\n\n  /**\n   * Sanitize a word by passing in the word and sanitization rules.\n   *\n   * @param  {string}   token\n   * @param  {string}   word\n   * @param  {Array}    rules\n   * @return {string}\n   */\n  function sanitizeWord (token, word, rules) {\n    // Empty string or doesn't need fixing.\n    if (!token.length || uncountables.hasOwnProperty(token)) {\n      return word;\n    }\n\n    var len = rules.length;\n\n    // Iterate over the sanitization rules and use the first one to match.\n    while (len--) {\n      var rule = rules[len];\n\n      if (rule[0].test(word)) return replace(word, rule);\n    }\n\n    return word;\n  }\n\n  /**\n   * Replace a word with the updated word.\n   *\n   * @param  {Object}   replaceMap\n   * @param  {Object}   keepMap\n   * @param  {Array}    rules\n   * @return {Function}\n   */\n  function replaceWord (replaceMap, keepMap, rules) {\n    return function (word) {\n      // Get the correct token and case restoration functions.\n      var token = word.toLowerCase();\n\n      // Check against the keep object map.\n      if (keepMap.hasOwnProperty(token)) {\n        return restoreCase(word, token);\n      }\n\n      // Check against the replacement map for a direct word replacement.\n      if (replaceMap.hasOwnProperty(token)) {\n        return restoreCase(word, replaceMap[token]);\n      }\n\n      // Run all the rules against the word.\n      return sanitizeWord(token, word, rules);\n    };\n  }\n\n  /**\n   * Check if a word is part of the map.\n   */\n  function checkWord (replaceMap, keepMap, rules, bool) {\n    return function (word) {\n      var token = word.toLowerCase();\n\n      if (keepMap.hasOwnProperty(token)) return true;\n      if (replaceMap.hasOwnProperty(token)) return false;\n\n      return sanitizeWord(token, token, rules) === token;\n    };\n  }\n\n  /**\n   * Pluralize or singularize a word based on the passed in count.\n   *\n   * @param  {string}  word      The word to pluralize\n   * @param  {number}  count     How many of the word exist\n   * @param  {boolean} inclusive Whether to prefix with the number (e.g. 3 ducks)\n   * @return {string}\n   */\n  function pluralize (word, count, inclusive) {\n    var pluralized = count === 1\n      ? pluralize.singular(word) : pluralize.plural(word);\n\n    return (inclusive ? count + ' ' : '') + pluralized;\n  }\n\n  /**\n   * Pluralize a word.\n   *\n   * @type {Function}\n   */\n  pluralize.plural = replaceWord(\n    irregularSingles, irregularPlurals, pluralRules\n  );\n\n  /**\n   * Check if a word is plural.\n   *\n   * @type {Function}\n   */\n  pluralize.isPlural = checkWord(\n    irregularSingles, irregularPlurals, pluralRules\n  );\n\n  /**\n   * Singularize a word.\n   *\n   * @type {Function}\n   */\n  pluralize.singular = replaceWord(\n    irregularPlurals, irregularSingles, singularRules\n  );\n\n  /**\n   * Check if a word is singular.\n   *\n   * @type {Function}\n   */\n  pluralize.isSingular = checkWord(\n    irregularPlurals, irregularSingles, singularRules\n  );\n\n  /**\n   * Add a pluralization rule to the collection.\n   *\n   * @param {(string|RegExp)} rule\n   * @param {string}          replacement\n   */\n  pluralize.addPluralRule = function (rule, replacement) {\n    pluralRules.push([sanitizeRule(rule), replacement]);\n  };\n\n  /**\n   * Add a singularization rule to the collection.\n   *\n   * @param {(string|RegExp)} rule\n   * @param {string}          replacement\n   */\n  pluralize.addSingularRule = function (rule, replacement) {\n    singularRules.push([sanitizeRule(rule), replacement]);\n  };\n\n  /**\n   * Add an uncountable word rule.\n   *\n   * @param {(string|RegExp)} word\n   */\n  pluralize.addUncountableRule = function (word) {\n    if (typeof word === 'string') {\n      uncountables[word.toLowerCase()] = true;\n      return;\n    }\n\n    // Set singular and plural references for the word.\n    pluralize.addPluralRule(word, '$0');\n    pluralize.addSingularRule(word, '$0');\n  };\n\n  /**\n   * Add an irregular word definition.\n   *\n   * @param {string} single\n   * @param {string} plural\n   */\n  pluralize.addIrregularRule = function (single, plural) {\n    plural = plural.toLowerCase();\n    single = single.toLowerCase();\n\n    irregularSingles[single] = plural;\n    irregularPlurals[plural] = single;\n  };\n\n  /**\n   * Irregular rules.\n   */\n  [\n    // Pronouns.\n    ['I', 'we'],\n    ['me', 'us'],\n    ['he', 'they'],\n    ['she', 'they'],\n    ['them', 'them'],\n    ['myself', 'ourselves'],\n    ['yourself', 'yourselves'],\n    ['itself', 'themselves'],\n    ['herself', 'themselves'],\n    ['himself', 'themselves'],\n    ['themself', 'themselves'],\n    ['is', 'are'],\n    ['was', 'were'],\n    ['has', 'have'],\n    ['this', 'these'],\n    ['that', 'those'],\n    // Words ending in with a consonant and `o`.\n    ['echo', 'echoes'],\n    ['dingo', 'dingoes'],\n    ['volcano', 'volcanoes'],\n    ['tornado', 'tornadoes'],\n    ['torpedo', 'torpedoes'],\n    // Ends with `us`.\n    ['genus', 'genera'],\n    ['viscus', 'viscera'],\n    // Ends with `ma`.\n    ['stigma', 'stigmata'],\n    ['stoma', 'stomata'],\n    ['dogma', 'dogmata'],\n    ['lemma', 'lemmata'],\n    ['schema', 'schemata'],\n    ['anathema', 'anathemata'],\n    // Other irregular rules.\n    ['ox', 'oxen'],\n    ['axe', 'axes'],\n    ['die', 'dice'],\n    ['yes', 'yeses'],\n    ['foot', 'feet'],\n    ['eave', 'eaves'],\n    ['goose', 'geese'],\n    ['tooth', 'teeth'],\n    ['quiz', 'quizzes'],\n    ['human', 'humans'],\n    ['proof', 'proofs'],\n    ['carve', 'carves'],\n    ['valve', 'valves'],\n    ['looey', 'looies'],\n    ['thief', 'thieves'],\n    ['groove', 'grooves'],\n    ['pickaxe', 'pickaxes'],\n    ['passerby', 'passersby']\n  ].forEach(function (rule) {\n    return pluralize.addIrregularRule(rule[0], rule[1]);\n  });\n\n  /**\n   * Pluralization rules.\n   */\n  [\n    [/s?$/i, 's'],\n    [/[^\\u0000-\\u007F]$/i, '$0'],\n    [/([^aeiou]ese)$/i, '$1'],\n    [/(ax|test)is$/i, '$1es'],\n    [/(alias|[^aou]us|t[lm]as|gas|ris)$/i, '$1es'],\n    [/(e[mn]u)s?$/i, '$1s'],\n    [/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i, '$1'],\n    [/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i, '$1i'],\n    [/(alumn|alg|vertebr)(?:a|ae)$/i, '$1ae'],\n    [/(seraph|cherub)(?:im)?$/i, '$1im'],\n    [/(her|at|gr)o$/i, '$1oes'],\n    [/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i, '$1a'],\n    [/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i, '$1a'],\n    [/sis$/i, 'ses'],\n    [/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i, '$1$2ves'],\n    [/([^aeiouy]|qu)y$/i, '$1ies'],\n    [/([^ch][ieo][ln])ey$/i, '$1ies'],\n    [/(x|ch|ss|sh|zz)$/i, '$1es'],\n    [/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i, '$1ices'],\n    [/\\b((?:tit)?m|l)(?:ice|ouse)$/i, '$1ice'],\n    [/(pe)(?:rson|ople)$/i, '$1ople'],\n    [/(child)(?:ren)?$/i, '$1ren'],\n    [/eaux$/i, '$0'],\n    [/m[ae]n$/i, 'men'],\n    ['thou', 'you']\n  ].forEach(function (rule) {\n    return pluralize.addPluralRule(rule[0], rule[1]);\n  });\n\n  /**\n   * Singularization rules.\n   */\n  [\n    [/s$/i, ''],\n    [/(ss)$/i, '$1'],\n    [/(wi|kni|(?:after|half|high|low|mid|non|night|[^\\w]|^)li)ves$/i, '$1fe'],\n    [/(ar|(?:wo|[ae])l|[eo][ao])ves$/i, '$1f'],\n    [/ies$/i, 'y'],\n    [/\\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i, '$1ie'],\n    [/\\b(mon|smil)ies$/i, '$1ey'],\n    [/\\b((?:tit)?m|l)ice$/i, '$1ouse'],\n    [/(seraph|cherub)im$/i, '$1'],\n    [/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i, '$1'],\n    [/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i, '$1sis'],\n    [/(movie|twelve|abuse|e[mn]u)s$/i, '$1'],\n    [/(test)(?:is|es)$/i, '$1is'],\n    [/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i, '$1us'],\n    [/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i, '$1um'],\n    [/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i, '$1on'],\n    [/(alumn|alg|vertebr)ae$/i, '$1a'],\n    [/(cod|mur|sil|vert|ind)ices$/i, '$1ex'],\n    [/(matr|append)ices$/i, '$1ix'],\n    [/(pe)(rson|ople)$/i, '$1rson'],\n    [/(child)ren$/i, '$1'],\n    [/(eau)x?$/i, '$1'],\n    [/men$/i, 'man']\n  ].forEach(function (rule) {\n    return pluralize.addSingularRule(rule[0], rule[1]);\n  });\n\n  /**\n   * Uncountable rules.\n   */\n  [\n    // Singular words with no plurals.\n    'adulthood',\n    'advice',\n    'agenda',\n    'aid',\n    'aircraft',\n    'alcohol',\n    'ammo',\n    'analytics',\n    'anime',\n    'athletics',\n    'audio',\n    'bison',\n    'blood',\n    'bream',\n    'buffalo',\n    'butter',\n    'carp',\n    'cash',\n    'chassis',\n    'chess',\n    'clothing',\n    'cod',\n    'commerce',\n    'cooperation',\n    'corps',\n    'debris',\n    'diabetes',\n    'digestion',\n    'elk',\n    'energy',\n    'equipment',\n    'excretion',\n    'expertise',\n    'firmware',\n    'flounder',\n    'fun',\n    'gallows',\n    'garbage',\n    'graffiti',\n    'hardware',\n    'headquarters',\n    'health',\n    'herpes',\n    'highjinks',\n    'homework',\n    'housework',\n    'information',\n    'jeans',\n    'justice',\n    'kudos',\n    'labour',\n    'literature',\n    'machinery',\n    'mackerel',\n    'mail',\n    'media',\n    'mews',\n    'moose',\n    'music',\n    'mud',\n    'manga',\n    'news',\n    'only',\n    'personnel',\n    'pike',\n    'plankton',\n    'pliers',\n    'police',\n    'pollution',\n    'premises',\n    'rain',\n    'research',\n    'rice',\n    'salmon',\n    'scissors',\n    'series',\n    'sewage',\n    'shambles',\n    'shrimp',\n    'software',\n    'species',\n    'staff',\n    'swine',\n    'tennis',\n    'traffic',\n    'transportation',\n    'trout',\n    'tuna',\n    'wealth',\n    'welfare',\n    'whiting',\n    'wildebeest',\n    'wildlife',\n    'you',\n    /pok[eé]mon$/i,\n    // Regexes.\n    /[^aeiou]ese$/i, // \"chinese\", \"japanese\"\n    /deer$/i, // \"deer\", \"reindeer\"\n    /fish$/i, // \"fish\", \"blowfish\", \"angelfish\"\n    /measles$/i,\n    /o[iu]s$/i, // \"carnivorous\"\n    /pox$/i, // \"chickpox\", \"smallpox\"\n    /sheep$/i\n  ].forEach(pluralize.addUncountableRule);\n\n  return pluralize;\n});\n","export function deflateHelper(store: any, data: any) {\r\n  function deflate(data: any): any {\r\n    if (!data || typeof data !== \"object\") return data\r\n    if (Array.isArray(data)) return data.map(deflate)\r\n\r\n    const { __typename, id } = data\r\n\r\n    if (__typename && store.isRootType(__typename)) {\r\n      // GQL object with root type, keep only __typename & id\r\n      return { __typename, id }\r\n    } else {\r\n      // GQL object with non-root type, return object with all props deflated\r\n      const snapshot: any = {}\r\n      for (const key in data) {\r\n        snapshot[key] = deflate(data[key])\r\n      }\r\n      return snapshot\r\n    }\r\n  }\r\n\r\n  return deflate(data)\r\n}\r\n","import { resolveIdentifier } from \"mobx-state-tree\"\nimport { typenameToCollectionName } from \"./utils\"\n\nexport function mergeHelper(store: any, data: any) {\n  function merge(data: any): any {\n    if (!data || typeof data !== \"object\") return data\n    if (Array.isArray(data)) return data.map(merge)\n\n    const { __typename, id } = data\n\n    // convert values deeply first to MST objects as much as possible\n    const snapshot: any = {}\n    for (const key in data) {\n      snapshot[key] = merge(data[key])\n    }\n\n    // GQL object\n    if (__typename && store.isKnownType(__typename)) {\n      // GQL object with known type, instantiate or recycle MST object\n      const typeDef = store.getTypeDef(__typename)\n      // Try to reuse instance, even if it is not a root type\n      let instance = id !== undefined && resolveIdentifier(typeDef, store, id)\n      if (instance) {\n        // update existing object\n        Object.assign(instance, snapshot)\n      } else {\n        // create a new one\n        instance = typeDef.create(snapshot)\n        if (store.isRootType(__typename)) {\n          // register in the store if a root\n          //store[typenameToCollectionName(__typename)].set(id, instance)\n          store[store.getCollectionName(__typename)].set(id, instance)\n        }\n        instance.__setStore(store)\n      }\n      return instance\n    } else {\n      // GQL object with unknown type, return verbatim\n      return snapshot\n    }\n  }\n\n  return merge(data)\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","'use strict';\n\nmodule.exports = function (data, opts) {\n    if (!opts) opts = {};\n    if (typeof opts === 'function') opts = { cmp: opts };\n    var cycles = (typeof opts.cycles === 'boolean') ? opts.cycles : false;\n\n    var cmp = opts.cmp && (function (f) {\n        return function (node) {\n            return function (a, b) {\n                var aobj = { key: a, value: node[a] };\n                var bobj = { key: b, value: node[b] };\n                return f(aobj, bobj);\n            };\n        };\n    })(opts.cmp);\n\n    var seen = [];\n    return (function stringify (node) {\n        if (node && node.toJSON && typeof node.toJSON === 'function') {\n            node = node.toJSON();\n        }\n\n        if (node === undefined) return;\n        if (typeof node == 'number') return isFinite(node) ? '' + node : 'null';\n        if (typeof node !== 'object') return JSON.stringify(node);\n\n        var i, out;\n        if (Array.isArray(node)) {\n            out = '[';\n            for (i = 0; i < node.length; i++) {\n                if (i) out += ',';\n                out += stringify(node[i]) || 'null';\n            }\n            return out + ']';\n        }\n\n        if (node === null) return 'null';\n\n        if (seen.indexOf(node) !== -1) {\n            if (cycles) return JSON.stringify('__cycle__');\n            throw new TypeError('Converting circular structure to JSON');\n        }\n\n        var seenIndex = seen.push(node) - 1;\n        var keys = Object.keys(node).sort(cmp && cmp(node));\n        out = '';\n        for (i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = stringify(node[key]);\n\n            if (!value) continue;\n            if (out) out += ',';\n            out += JSON.stringify(key) + ':' + value;\n        }\n        seen.splice(seenIndex, 1);\n        return '{' + out + '}';\n    })(data);\n};\n","// @ts-ignore\nimport stringify from \"fast-json-stable-stringify\"\nimport { DocumentNode, print } from \"graphql\"\n\nimport { StoreType } from \"./MSTGQLStore\"\nimport { action, observable } from \"mobx\"\n\nexport type CaseHandlers<T, R> = {\n  loading(): R\n  error(error: any): R\n  data(data: T): R\n}\n\nexport type FetchPolicy =\n  | \"cache-first\" // Use cache if available, avoid network request if possible\n  | \"cache-only\" // Use cache if available, or error\n  | \"cache-and-network\" // Use cache, but still send request and update cache in the background\n  | \"network-only\" // Skip cache, but cache the result\n  | \"no-cache\" // Skip cache, and don't cache the response either\n\nexport interface QueryOptions {\n  fetchPolicy?: FetchPolicy\n  noSsr?: boolean\n}\n\nconst isServer: boolean = typeof window === \"undefined\"\n\nexport class Query<T = unknown> implements PromiseLike<T> {\n  @observable loading = false\n  @observable.ref data: T | undefined = undefined\n  @observable error: any = undefined\n\n  public query: string\n  public promise!: Promise<T>\n  private fetchPolicy: FetchPolicy\n  private queryKey: string\n\n  constructor(\n    public store: StoreType,\n    query: string | DocumentNode,\n    public variables: any,\n    public options: QueryOptions = {}\n  ) {\n    this.query = typeof query === \"string\" ? query : print(query)\n    this.queryKey = this.query + stringify(variables)\n\n    let fetchPolicy = options.fetchPolicy || \"cache-and-network\"\n    if (\n      this.store.ssr &&\n      !this.options.noSsr &&\n      (isServer || !store.__afterInit)\n    ) {\n      fetchPolicy = \"cache-first\"\n    }\n    this.fetchPolicy = fetchPolicy\n\n    if (this.store.ssr && this.options.noSsr && isServer) {\n      this.promise = Promise.resolve() as any\n      return\n    }\n\n    const inCache = this.store.__queryCache.has(this.queryKey)\n    switch (this.fetchPolicy) {\n      case \"no-cache\":\n      case \"network-only\":\n        this.fetchResults()\n        break\n      case \"cache-only\":\n        if (!inCache) {\n          this.error = new Error(\n            `No results for query ${this.query} found in cache, and policy is cache-only`\n          )\n          this.promise = Promise.reject(this.error)\n        } else {\n          this.useCachedResults()\n        }\n        break\n      case \"cache-and-network\":\n        if (inCache) {\n          this.useCachedResults()\n          this.refetch() // refetch async, so that callers chaining to the initial promise should resovle immediately!\n        } else {\n          this.fetchResults()\n        }\n        break\n      case \"cache-first\":\n        if (inCache) {\n          this.useCachedResults()\n        } else {\n          this.fetchResults()\n        }\n        break\n    }\n  }\n\n  refetch = (): Promise<T> => {\n    return Promise.resolve().then(\n      action(() => {\n        if (!this.loading) {\n          this.fetchResults()\n        }\n        return this.promise\n      })\n    )\n  }\n\n  private fetchResults() {\n    this.loading = true\n    let promise: Promise<T>\n    const existingPromise = this.store.__promises.get(this.queryKey)\n    if (existingPromise) {\n      promise = existingPromise as Promise<T>\n    } else {\n      promise = this.store.rawRequest(this.query, this.variables)\n      this.store.__pushPromise(promise, this.queryKey)\n    }\n    promise = promise.then((data: any) => {\n      // cache query and response\n      if (this.fetchPolicy !== \"no-cache\") {\n        this.store.__cacheResponse(this.queryKey, this.store.deflate(data))\n      }\n      return this.store.merge(data)\n    })\n    this.promise = promise\n    promise.then(\n      action((data: any) => {\n        this.loading = false\n        this.error = false\n        this.data = data\n      }),\n      action(error => {\n        this.loading = false\n        this.error = error\n      })\n    )\n  }\n\n  private useCachedResults() {\n    this.data = this.store.merge(this.store.__queryCache.get(this.queryKey))\n    this.promise = Promise.resolve(this.data!)\n  }\n\n  case<R>(handlers: CaseHandlers<T, R>): R {\n    return this.loading && !this.data\n      ? handlers.loading()\n      : this.error\n      ? handlers.error(this.error)\n      : handlers.data(this.data!)\n  }\n\n  currentPromise() {\n    return this.promise\n  }\n\n  then<TResult1 = T, TResult2 = never>(\n    onfulfilled?:\n      | ((value: T) => TResult1 | PromiseLike<TResult1>)\n      | undefined\n      | null,\n    onrejected?:\n      | ((reason: any) => TResult2 | PromiseLike<TResult2>)\n      | undefined\n      | null\n  ): PromiseLike<TResult1 | TResult2>\n  then(onfulfilled: any, onrejected: any) {\n    return this.promise.then(\n      d => {\n        this.store.__runInStoreContext(() => onfulfilled(d))\n      },\n      e => {\n        this.store.__runInStoreContext(() => onrejected(e))\n      }\n    )\n  }\n}\n","export function getFirstValue(data: any) {\n  const keys = Object.keys(data)\n  if (keys.length !== 1)\n    throw new Error(\n      `Expected exactly one response key, got: ${keys.join(\", \")}`\n    )\n  return data[keys[0]]\n}\n\nexport function typenameToCollectionName(typename: string) {\n  return typename.toLowerCase() + \"s\"\n}\n","import camelcase from \"camelcase\"\nimport { DocumentNode } from \"graphql\"\nimport { getEnv, IAnyModelType, recordPatches, types } from \"mobx-state-tree\"\nimport pluralize from \"pluralize\"\nimport { SubscriptionClient } from \"subscriptions-transport-ws\"\nimport { deflateHelper } from \"./deflateHelper\"\n\nimport { mergeHelper } from \"./mergeHelper\"\nimport { Query, QueryOptions } from \"./Query\"\nimport { getFirstValue } from \"./utils\"\n\nexport interface RequestHandler<T = any> {\n  request(query: string, variables: any): Promise<T>\n}\n\n// TODO: also provide an interface for stream handler\n\nexport const MSTGQLStore = types\n  .model(\"MSTGQLStore\", {\n    __queryCache: types.optional(types.map(types.frozen()), {})\n  })\n  .volatile((self): {\n    ssr: boolean\n    __promises: Map<string, Promise<unknown>>\n    __afterInit: boolean\n  } => {\n    const {\n      ssr = false\n    }: {\n      ssr: boolean\n    } = getEnv(self)\n    return {\n      ssr,\n      __promises: new Map(),\n      __afterInit: false\n    }\n  })\n  .actions(self => {\n    Promise.resolve().then(() => (self as any).__onAfterInit())\n\n    const {\n      gqlHttpClient, // TODO: rename to requestHandler\n      gqlWsClient // TODO: rename to streamHandler\n    }: {\n      gqlHttpClient: RequestHandler\n      gqlWsClient: SubscriptionClient\n    } = getEnv(self)\n    if (!gqlHttpClient && !gqlWsClient)\n      throw new Error(\n        \"Either gqlHttpClient or gqlWsClient (or both) should provided in the MSTGQLStore environment\"\n      )\n\n    function merge(data: unknown) {\n      return mergeHelper(self, data)\n    }\n\n    function deflate(data: unknown) {\n      return deflateHelper(self, data)\n    }\n\n    function rawRequest(query: string, variables: any): Promise<any> {\n      if (gqlHttpClient) return gqlHttpClient.request(query, variables)\n      else {\n        return new Promise((resolve, reject) => {\n          gqlWsClient\n            .request({\n              query,\n              variables\n            })\n            .subscribe({\n              next(data) {\n                resolve(data.data)\n              },\n              error: reject\n            })\n        })\n      }\n    }\n\n    function query<T>(\n      query: string | DocumentNode,\n      variables?: any,\n      options: QueryOptions = {}\n    ): Query<T> {\n      return new Query(self as StoreType, query, variables, options)\n    }\n\n    function mutate<T>(\n      mutation: string | DocumentNode,\n      variables?: any,\n      optimisticUpdate?: () => void\n    ): Query<T> {\n      if (optimisticUpdate) {\n        const recorder = recordPatches(self)\n        optimisticUpdate()\n        recorder.stop()\n        const q = query<T>(mutation, variables, {\n          fetchPolicy: \"network-only\"\n        })\n        q.currentPromise().catch(() => {\n          recorder.undo()\n        })\n        return q\n      } else {\n        return query(mutation, variables, {\n          fetchPolicy: \"network-only\"\n        })\n      }\n    }\n\n    // N.b: the T is ignored, but it does simplify code generation\n    function subscribe<T = any>(\n      query: string | DocumentNode,\n      variables?: any,\n      onData?: (item: T) => void,\n      onError: (error: Error) => void = error => {\n        throw error\n      }\n    ): () => void {\n      if (!gqlWsClient) throw new Error(\"No WS client available\")\n      const sub = gqlWsClient\n        .request({\n          query,\n          variables\n        })\n        .subscribe({\n          next(data) {\n            if (data.errors) {\n              return onError(new Error(JSON.stringify(data.errors)))\n            }\n            ;(self as any).__runInStoreContext(() => {\n              const res = (self as any).merge(getFirstValue(data.data))\n              if (onData) onData(res)\n              return res\n            })\n          }\n        })\n      return () => sub.unsubscribe()\n    }\n\n    // exposed actions\n    return {\n      merge,\n      deflate,\n      mutate,\n      query,\n      subscribe,\n      rawRequest,\n      __pushPromise(promise: Promise<{}>, queryKey: string) {\n        self.__promises.set(queryKey, promise)\n        const onSettled = () => self.__promises.delete(queryKey)\n        promise.then(onSettled, onSettled)\n      },\n      __runInStoreContext<T>(fn: () => T) {\n        return fn()\n      },\n      __cacheResponse(key: string, response: any) {\n        self.__queryCache.set(key, response)\n      },\n      __onAfterInit() {\n        self.__afterInit = true\n      }\n    }\n  })\n\nexport function configureStoreMixin(\n  knownTypes: [string, () => IAnyModelType][],\n  rootTypes: string[],\n  namingConvention?: string\n) {\n  const kt = new Map()\n  const rt = new Set(rootTypes)\n  return () => ({\n    actions: {\n      afterCreate() {\n        // initialized lazily, so that there are no circular dep issues\n        knownTypes.forEach(([key, typeFn]) => {\n          const type = typeFn()\n          if (!type)\n            throw new Error(\n              `The type provided for '${key}' is empty. Probably this is a module loading issue`\n            )\n          kt.set(key, type)\n        })\n      }\n    },\n    views: {\n      isKnownType(typename: string): boolean {\n        return kt.has(typename)\n      },\n      isRootType(typename: string): boolean {\n        return rt.has(typename)\n      },\n      getTypeDef(typename: string): IAnyModelType {\n        return kt.get(typename)!\n      },\n      getCollectionName(typename: string): string {\n        if (namingConvention == \"js\") {\n          // Pluralize only last word (pluralize may fail with words that are\n          // not valid English words as is the case with LongCamelCaseTypeNames)\n          const newName = camelcase(typename)\n          const parts = newName.split(/(?=[A-Z])/)\n          parts[parts.length - 1] = pluralize(parts[parts.length - 1])\n          return parts.join(\"\")\n        }\n        return typename.toLowerCase() + \"s\"\n      }\n    }\n  })\n}\n\nexport type StoreType = typeof MSTGQLStore.Type\n","import {\n  types,\n  getParent,\n  IAnyModelType,\n  resolveIdentifier,\n  IReferenceType\n} from \"mobx-state-tree\"\nimport { observable } from \"mobx\"\n\nimport { StoreType } from \"./MSTGQLStore\"\n\n/*\n For detached objects (objects that are not part of the Roots, or one of their children, for example: query results),\n we cannot use the default resolution mechanism, since they are not part of the store. So, first fetch the store and resolve from there\n*/\nexport function MSTGQLRef<T extends IAnyModelType>(\n  targetType: T\n): IReferenceType<T> {\n  return types.reference(targetType, {\n    get(id: string, parent: any) {\n      const node = resolveIdentifier(\n        targetType,\n        parent.store || getParent<any>(parent).store,\n        id\n      )\n      if (!node) {\n        throw new Error(\n          `Failed to resolve reference ${id} to ${targetType.name}`\n        )\n      }\n      return node\n    },\n    set(value: any) {\n      return value.id\n    }\n  })\n}\n\nexport const MSTGQLObject = types.model(\"MSTGQLObject\").extend(self => {\n  let store: StoreType\n\n  function getStore(): StoreType {\n    return store || (store = getParent(self, 2))\n  }\n\n  return {\n    actions: {\n      __setStore(s: StoreType) {\n        store = s\n      }\n    },\n    views: {\n      __getStore<T>() {\n        return (getStore() as any) as T\n      },\n      hasLoaded(key: string): boolean {\n        return typeof (self as any)[key] !== \"undefined\"\n      }\n    }\n  }\n})\n","import { GraphQLClient } from \"graphql-request\"\n\nexport type HttpClientOptions = ConstructorParameters<typeof GraphQLClient>[1]\n\nexport function createHttpClient(url: string, options: HttpClientOptions = {}) {\n  return new GraphQLClient(url, options)\n}\n","export abstract class QueryBuilder {\n  __query: string = \"\"\n\n  public constructor() {\n    this.__attr(\"__typename\")\n    if (typeof (this as any).id === \"function\") (this as any).id()\n  }\n\n  protected __attr(attr: string): this {\n    return this._(attr)\n  }\n\n  // raw is exposed, to be able to add free form gql in the middle\n  public _(str: string): this {\n    this.__query += `${str}\\n` // TODO: restore depth / formatting by passing base depth to constructor: ${\"\".padStart(this.__qb.stack.length * 2)}\n    return this\n  }\n\n  protected __child<T extends QueryBuilder>(\n    childName: string,\n    childType: new () => T,\n    builder?: string | ((q: T) => T) | T\n  ): this {\n    this._(`${childName} {\\n`)\n    this.__buildChild(childType, builder)\n    this._(`}`)\n    return this\n  }\n\n  // used for interfaces and unions\n  protected __inlineFragment<T extends QueryBuilder>(\n    childName: string,\n    childType: new () => T,\n    builder?: string | ((q: T) => T) | T\n  ) {\n    this._(`... on ${childName} {\\n`)\n    this.__buildChild(childType, builder)\n    this._(`}`)\n    return this\n  }\n\n  protected __buildChild<T extends QueryBuilder>(\n    childType: new () => T,\n    builder?: string | ((q: T) => T) | T\n  ) {\n    // already instantiated child builder\n    if (builder instanceof QueryBuilder) {\n      this._(builder.toString())\n    } else {\n      const childBuilder = new childType()\n      if (typeof builder === \"string\") childBuilder._(builder)\n      else if (typeof builder === \"function\") builder(childBuilder)\n      // undefined is ok as well, no fields at all\n      this._(childBuilder.toString())\n    }\n  }\n\n  public toString() {\n    return this.__query\n  }\n}\n","/* eslint-disable no-undefined,no-param-reassign,no-shadow */\n\n/**\n * Throttle execution of a function. Especially useful for rate limiting\n * execution of handlers on events like resize and scroll.\n *\n * @param  {Number}    delay          A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {Boolean}   [noTrailing]   Optional, defaults to false. If noTrailing is true, callback will only execute every `delay` milliseconds while the\n *                                    throttled-function is being called. If noTrailing is false or unspecified, callback will be executed one final time\n *                                    after the last throttled-function call. (After the throttled-function has not been called for `delay` milliseconds,\n *                                    the internal counter is reset)\n * @param  {Function}  callback       A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                    to `callback` when the throttled-function is executed.\n * @param  {Boolean}   [debounceMode] If `debounceMode` is true (at begin), schedule `clear` to execute after `delay` ms. If `debounceMode` is false (at end),\n *                                    schedule `callback` to execute after `delay` ms.\n *\n * @return {Function}  A new, throttled, function.\n */\nfunction throttle (delay, noTrailing, callback, debounceMode) {\n  /*\n   * After wrapper has stopped being called, this timeout ensures that\n   * `callback` is executed at the proper times in `throttle` and `end`\n   * debounce modes.\n   */\n  var timeoutID;\n  var cancelled = false; // Keep track of the last time `callback` was executed.\n\n  var lastExec = 0; // Function to clear existing timeout\n\n  function clearExistingTimeout() {\n    if (timeoutID) {\n      clearTimeout(timeoutID);\n    }\n  } // Function to cancel next exec\n\n\n  function cancel() {\n    clearExistingTimeout();\n    cancelled = true;\n  } // `noTrailing` defaults to falsy.\n\n\n  if (typeof noTrailing !== 'boolean') {\n    debounceMode = callback;\n    callback = noTrailing;\n    noTrailing = undefined;\n  }\n  /*\n   * The `wrapper` function encapsulates all of the throttling / debouncing\n   * functionality and when executed will limit the rate at which `callback`\n   * is executed.\n   */\n\n\n  function wrapper() {\n    var self = this;\n    var elapsed = Date.now() - lastExec;\n    var args = arguments;\n\n    if (cancelled) {\n      return;\n    } // Execute `callback` and update the `lastExec` timestamp.\n\n\n    function exec() {\n      lastExec = Date.now();\n      callback.apply(self, args);\n    }\n    /*\n     * If `debounceMode` is true (at begin) this is used to clear the flag\n     * to allow future `callback` executions.\n     */\n\n\n    function clear() {\n      timeoutID = undefined;\n    }\n\n    if (debounceMode && !timeoutID) {\n      /*\n       * Since `wrapper` is being called for the first time and\n       * `debounceMode` is true (at begin), execute `callback`.\n       */\n      exec();\n    }\n\n    clearExistingTimeout();\n\n    if (debounceMode === undefined && elapsed > delay) {\n      /*\n       * In throttle mode, if `delay` time has been exceeded, execute\n       * `callback`.\n       */\n      exec();\n    } else if (noTrailing !== true) {\n      /*\n       * In trailing throttle mode, since `delay` time has not been\n       * exceeded, schedule `callback` to execute `delay` ms after most\n       * recent execution.\n       *\n       * If `debounceMode` is true (at begin), schedule `clear` to execute\n       * after `delay` ms.\n       *\n       * If `debounceMode` is false (at end), schedule `callback` to\n       * execute after `delay` ms.\n       */\n      timeoutID = setTimeout(debounceMode ? clear : exec, debounceMode === undefined ? delay - elapsed : delay);\n    }\n  }\n\n  wrapper.cancel = cancel; // Return the wrapper function.\n\n  return wrapper;\n}\n\n/* eslint-disable no-undefined */\n/**\n * Debounce execution of a function. Debouncing, unlike throttling,\n * guarantees that a function is only executed a single time, either at the\n * very beginning of a series of calls, or at the very end.\n *\n * @param  {Number}   delay         A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {Boolean}  [atBegin]     Optional, defaults to false. If atBegin is false or unspecified, callback will only be executed `delay` milliseconds\n *                                  after the last debounced-function call. If atBegin is true, callback will be executed only at the first debounced-function call.\n *                                  (After the throttled-function has not been called for `delay` milliseconds, the internal counter is reset).\n * @param  {Function} callback      A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                  to `callback` when the debounced-function is executed.\n *\n * @return {Function} A new, debounced function.\n */\n\nfunction debounce (delay, atBegin, callback) {\n  return callback === undefined ? throttle(delay, atBegin, false) : throttle(delay, callback, atBegin !== false);\n}\n\nexport { throttle, debounce };\n","import { StoreType } from \"./MSTGQLStore\"\nimport {\n  getType,\n  applySnapshot,\n  addDisposer,\n  onSnapshot\n} from \"mobx-state-tree\"\n\nimport { throttle } from \"throttle-debounce\"\n\n// TODO: support skipping parts of the store, with a key filter for example\ntype LocalStorageMixinOptions = {\n  storage?: {\n    getItem(key: string): string | null | Promise<string | null>\n    setItem(key: string, data: string): void\n  }\n  throttle?: number // How often the snapshot is written to local storage\n  storageKey?: string\n}\nexport function localStorageMixin(options: LocalStorageMixinOptions = {}) {\n  const storage = options.storage || window.localStorage\n  const throttleInterval = options.throttle || 5000\n  const storageKey = options.storageKey || \"mst-gql-rootstore\"\n  return (self: StoreType) => ({\n    actions: {\n      async afterCreate() {\n        const data = await storage.getItem(storageKey)\n        if (data) {\n          const json = JSON.parse(data)\n          const selfType = getType(self)\n          if (!selfType.is(json)) {\n            console.warn(\n              `Data in local storage does not conform the data shape specified by ${selfType.name}, ignoring the stored data`\n            )\n            return\n          }\n          applySnapshot(self, json)\n        }\n        addDisposer(\n          self,\n          onSnapshot(\n            self,\n            throttle(throttleInterval, (data: any) => {\n              storage.setItem(storageKey, JSON.stringify(data))\n            })\n          )\n        )\n      }\n    }\n  })\n}\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import { DocumentNode } from \"graphql\"\n\nimport { Query, FetchPolicy } from \"./Query\"\nimport { MSTGQLStore } from \"./MSTGQLStore\"\n\n// import react namespace only; statement gets removed after transpiling\ndeclare var ReactNamespace: typeof import(\"react\")\n\nexport type QueryLike<STORE, DATA> =\n  | ((store: STORE) => Query<DATA>)\n  | Query<DATA>\n  | string\n  | DocumentNode\n\nexport function createStoreContext<STORE extends typeof MSTGQLStore.Type>(\n  React: typeof ReactNamespace\n) {\n  return React.createContext<STORE>(null as any)\n}\n\nexport async function getDataFromTree<STORE extends typeof MSTGQLStore.Type>(\n  tree: React.ReactElement<any>,\n  client: STORE,\n  renderFunction: (\n    tree: React.ReactElement<any>\n  ) => string = require(\"react-dom/server\").renderToStaticMarkup\n): Promise<string> {\n  while (true) {\n    const html = renderFunction(tree)\n    if (client.__promises.size === 0) {\n      return html\n    }\n    await Promise.all(client.__promises.values())\n  }\n}\n\nfunction normalizeQuery<STORE extends typeof MSTGQLStore.Type, DATA>(\n  store: STORE,\n  query: QueryLike<STORE, DATA>,\n  {\n    variables,\n    fetchPolicy = \"cache-and-network\"\n  }: {\n    variables?: any\n    fetchPolicy?: FetchPolicy\n  }\n): Query<DATA> {\n  if (typeof query === \"function\") return query(store)\n  if (query instanceof Query) return query\n  return store.query(query, variables, {\n    fetchPolicy: fetchPolicy\n  })\n}\n\nexport type UseQueryHookOptions<STORE> = {\n  store?: STORE\n  variables?: any\n  fetchPolicy?: FetchPolicy\n}\n\nexport type UseQueryHookResult<STORE, DATA> = {\n  store: STORE\n  loading: boolean\n  error: any\n  data: { [key in keyof DATA]: DATA[key] } | undefined\n  // prevData: DATA | undefined // set of previously fetched values, in case the query was replaced\n  query: Query<DATA> | undefined\n  setQuery: (query: QueryLike<STORE, DATA>) => void\n}\n\nexport type UseQueryHook<STORE> = <DATA>(\n  query?: QueryLike<STORE, DATA>,\n  options?: UseQueryHookOptions<STORE>\n) => UseQueryHookResult<STORE, DATA>\n\nexport function createUseQueryHook<STORE extends typeof MSTGQLStore.Type>(\n  context: React.Context<STORE>,\n  React: typeof ReactNamespace\n): UseQueryHook<STORE> {\n  return function<DATA>(\n    queryIn: undefined | QueryLike<STORE, DATA> = undefined,\n    opts: UseQueryHookOptions<STORE> = {}\n  ) {\n    const store = (opts && opts.store) || React.useContext(context)\n    // const prevData = useRef<DATA>() // TODO: is this useful?\n    const [query, setQuery] = React.useState<Query<DATA> | undefined>(() => {\n      if (!queryIn) return undefined\n      return normalizeQuery(store, queryIn, opts)\n    })\n\n    const setQueryHelper = React.useCallback(\n      (newQuery: QueryLike<STORE, DATA>) => {\n        // if the current query had results already, save it in prevData\n        // if (query && query.data) prevData.current = query.data\n        setQuery(normalizeQuery(store, newQuery, opts))\n      },\n      []\n    )\n\n    // if new query or variables are passed in, replace the query!\n    React.useEffect(() => {\n      if (!queryIn || typeof queryIn === \"function\") return // ignore changes to initializer func\n      setQueryHelper(queryIn)\n    }, [queryIn, opts.fetchPolicy, JSON.stringify(opts.variables)]) // TODO: use a decent deep equal\n\n    return {\n      store,\n      loading: query ? query.loading : false,\n      error: query && query.error,\n      data: query && query.data,\n      // prevData: prevData.current,\n      query,\n      setQuery: setQueryHelper\n    }\n  }\n}\n","import { IAnyModelType, IModelType } from \"mobx-state-tree\"\n\ntype Without<T, K> = Pick<T, Exclude<keyof T, K>>\n\ntype WithRefsModelType<T extends IAnyModelType, OTHERS> = T extends IModelType<\n  infer P,\n  infer O,\n  infer C,\n  infer S\n>\n  ? IModelType<Without<P, keyof OTHERS>, O & OTHERS, C, S>\n  : never\n\nexport function withTypedRefs<REFS>() {\n  return function<T extends IAnyModelType>(model: T) {\n    return (model as unknown) as WithRefsModelType<T, REFS>\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}